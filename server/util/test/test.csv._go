package main

import (
	"encoding/csv"
	"os"
	"strconv"
)

func main() {
	fileName := "./hello.xls"
	file, err := os.Create(fileName)
	if err != nil {
		panic(err)
	}
	defer file.Close()
	file.WriteString("\xEF\xBB\xBF") // 写入UTF-8 BOM

	w := csv.NewWriter(file)
	w.Write([]string{"id", "姓名", "sd"})

	for i := 1; i < 11; i++ {
		id := strconv.FormatInt(int64(i), 10)
		name := "name-" + id
		w.Write([]string{id, name, "对了"})
	}

	w.Flush()

	records := [][]string{}
	for i := 1; i < 11; i++ {
		id := strconv.FormatInt(int64(i), 10)
		name := "name-" + id
		str := []string{id, name, "对了"}
		records = append(records, str)
	}

	w.WriteAll(records)
}
